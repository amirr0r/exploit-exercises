# Net 0

This level takes a look at converting strings to little endian integers.

This level is at `/opt/protostar/bin/net0`

```c
#include "../common/common.c"

#define NAME "net0"
#define UID 999
#define GID 999
#define PORT 2999

void run()
{
  unsigned int i;
  unsigned int wanted;Please send '%d' as a little endian 32bit intndom();

  printf("Please send '%d' as a little endian 32bit int\n", wanted);

  if(fread(&i, sizeof(i), 1, stdin) == NULL) {
      errx(1, ":(\n");
  }

  if(i == wanted) {
      printf("Thank you sir/madam\n");
  } else {
      printf("I'm sorry, you sent %d instead\n", i);
  }
}

int main(int argc, char **argv, char **envp)
{
  int fd;
  char *username;

  /* Run the process as a daemon */
  background_process(NAME, UID, GID); 
  
  /* Wait for socket activity and return */
  fd = serve_forever(PORT);

  /* Set the client socket to STDIN, STDOUT, and STDERR */
  set_io(fd);

  /* Don't do this :> */
  srandom(time(NULL));

  run();
}
```

## Solution

Once `./net0` is executed it runs the process as a daemon on port 2999:

```console
user@protostar:/opt/protostar/bin$ ./net0
user@protostar:/opt/protostar/bin$ ps auxf | grep net0
999       1670  0.0  0.0   1532   272 ?        Ss   03:23   0:00 /opt/protostar/bin/net0
user@protostar:/opt/protostar/bin$ su - root
Password: 
No directory, logging in with HOME=/
root@protostar:/# netstat -tulpn
Active Internet connections (only servers)
...
tcp        0      0 0.0.0.0:2999            0.0.0.0:*               LISTEN      1670/net0
...
```

The IP address of my Protostar VM is `192.168.1.251`.

### Python (`pwntools`)

```python
import pwn

host = "192.168.1.251"
port = 2999

r = pwn.remote(host,port) # Connecting to Protostar VM (opening a socket)

message = r.recvline().strip() # Getting the first message 'Please send ...' + removing the '\n' with .strip()
number = int(message.decode().split("'")[1]) # Extracting the number we have to send

pwn.info(message) # Printing the message we received

r.sendline(pwn.p32(number)) # Sending the number we extracted converted into little endian integer

pwn.success(r.recvline().strip()) # Printing the response 'Thank you sir/madam'

r.close() # Closing the connection (socket)
```